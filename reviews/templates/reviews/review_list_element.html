{% load range %}

{% for review in review_list %}
  <div class="card md:card-side bg-base-100 shadow-xl md:h-80">
    <figure class="relative shrink-0">
      <div class="absolute text-white h-full w-full flex flex-col justify-end bg-gradient-to-t from-black">
        <div class="text-center text-4xl text-primary font-normal -mb-4 font-serif">“</div>
        <div class="text-center text-2xl md:text-base text-primary px-4 ">
          {{ review.short_review }}
        </div>
        <div class="text-center text-4xl font-normal text-primary -mb-4 font-serif">”</div>
        <div class="text-center text-xl font-bold text-primary px-4 pb-2">- {{ review.profile }}</div>
      </div>
      <img class="w-full md:h-full md:w-none" src="{{ review.film.poster.url }}" alt="Movie Poster">
    </figure>
    <div class="card-body grow-0 w-full justify-between">
      <div class="space-y-2">
        <h2 class="card-title myh2">
          <a class="link link-primary" href="{% url "films:detail" review.film.slug %}">
            {{ review.film }} 
          </a>
          by 
          <a class="link link-primary" href="{% url "profiles:main" review.profile %}">{{ review.profile }}</a>
        </h2>
        <div class="rating rating-md">
          {% for i in 5|get_range  %}
            <input disabled type="radio" class="mask mask-star-2 bg-prime" {% if i == review.rating %} checked {% endif %} />
          {% endfor %}
        </div>
        <div class="line-clamp-3 md:line-clamp-5">
          {{ review.full_review }}
        </div>
      </div>
      <div class="card-actions justify-between">
        <svg aria-label="Like" fill="currentColor" height="24" role="img" viewBox="0 0 24 24" width="24">
          <title>Like</title>
          <path d="M16.792 3.904A4.989 4.989 0 0 1 21.5 9.122c0 3.072-2.652 4.959-5.197 7.222-2.512 2.243-3.865 3.469-4.303 3.752-.477-.309-2.143-1.823-4.303-3.752C5.141 14.072 2.5 12.167 2.5 9.122a4.989 4.989 0 0 1 4.708-5.218 4.21 4.21 0 0 1 3.675 1.941c.84 1.175.98 1.763 1.12 1.763s.278-.588 1.11-1.766a4.17 4.17 0 0 1 3.679-1.938m0-2a6.04 6.04 0 0 0-4.797 2.127 6.052 6.052 0 0 0-4.787-2.127A6.985 6.985 0 0 0 .5 9.122c0 3.61 2.55 5.827 5.015 7.97.283.246.569.494.853.747l1.027.918a44.998 44.998 0 0 0 3.518 3.018 2 2 0 0 0 2.174 0 45.263 45.263 0 0 0 3.626-3.115l.922-.824c.293-.26.59-.519.885-.774 2.334-2.025 4.98-4.32 4.98-7.94a6.985 6.985 0 0 0-6.708-7.218Z"></path>
        </svg>
        <div class="flex">
          <div>
            <a class="link link-secondary" href="{% url "reviews:detail" review.id %}">อ่านรีวิวเต็ม</a>
            
            {% if review.is_spoiler  %}
            <div class="tooltip tooltip tooltip-error" data-tip="spoiler alert">
              ⚠️
            </div>
            {% endif %}
          </div>
          {% comment %} <svg class="size-6 hover:size-8 fill-error" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
            <!--!Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.-->
            <path d="M256 32c14.2 0 27.3 7.5 34.5 19.8l216 368c7.3 12.4 7.3 27.7 .2 40.1S486.3 480 472 480H40c-14.3 0-27.6-7.7-34.7-20.1s-7-27.8 .2-40.1l216-368C228.7 39.5 241.8 32 256 32zm0 128c-13.3 0-24 10.7-24 24V296c0 13.3 10.7 24 24 24s24-10.7 24-24V184c0-13.3-10.7-24-24-24zm32 224a32 32 0 1 0 -64 0 32 32 0 1 0 64 0z"/>
          </svg> {% endcomment %}
        </div>
      </div>
    </div>
  </div>
  {% if forloop.last and page_obj.has_next %}
    <div class="divider" hx-get="{% url "reviews:feed" %}?page={{ page_obj.number|add:1 }}" hx-trigger="revealed" hx-swap="afterend" hx-target="this" hx-indicator="#indicator"></div>

  {% else %}
    <div class="divider"></div>
  {% endif %}
{% endfor %}